---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { SITE_DESCRIPTION, SITE_TITLE, DOC_SOURCE_URL } from '../consts';
import { getEntry, render } from 'astro:content';

const doc = await getEntry('docs', 'filesystem');

if (!doc) {
	throw new Error('Filesystem doc is missing');
}

const { Content } = await render(doc);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead
			title={doc.data.title ?? SITE_TITLE}
			description={doc.data.description ?? SITE_DESCRIPTION}
		/>
	</head>
	<body>
		<Header />
		<main>
			<header class="page-hero">
				<p class="eyebrow">{SITE_TITLE}</p>
				<h1>{doc.data.title}</h1>
				<p class="lede">{doc.data.description}</p>
				<div class="cta">
					<a class="button" href="#doc">Read online</a>
					<a class="ghost" href={doc.data.source ?? DOC_SOURCE_URL} target="_blank" rel="noreferrer"
						>View as Markdown</a
					>
				</div>
			</header>

			<article id="doc" class="doc">
				<Content />
			</article>
		</main>
		<Footer />
	</body>
</html>

<style>
	.page-hero {
		margin-bottom: 3rem;
		padding: 2rem 0;
	}
	.eyebrow {
		text-transform: uppercase;
		letter-spacing: 0.15em;
		font-size: 0.75em;
		color: rgb(var(--gray));
		margin: 0 0 1rem 0;
		font-weight: 500;
	}
	.lede {
		max-width: 60ch;
		font-size: 1.1em;
		line-height: 1.7;
		color: rgb(var(--gray-dark));
	}
	.cta {
		display: flex;
		flex-wrap: wrap;
		gap: 1rem;
		margin-top: 2rem;
	}
	.button,
	.ghost {
		display: inline-block;
		padding: 0.75rem 1.5rem;
		border-radius: 4px;
		text-decoration: none;
		font-weight: 400;
		border: 1px solid transparent;
		font-size: 0.95em;
		letter-spacing: 0.02em;
		transition: all 0.2s ease;
	}
	.button {
		background: rgb(var(--black));
		color: white;
	}
	.button:hover {
		background: rgb(var(--gray-dark));
	}
	.ghost {
		border-color: rgb(var(--black));
		color: rgb(var(--black));
	}
	.ghost:hover {
		background: rgba(var(--black), 0.05);
	}
	.doc {
		background: white;
		border-radius: 8px;
		box-shadow: var(--box-shadow);
		padding: 3rem 3.5rem;
		border: 1px solid rgba(var(--black), 0.06);
	}
	.doc :global(:is(h2, h3)) {
		margin-top: 1.5rem;
	}
	@media (max-width: 720px) {
		.button,
		.ghost {
			width: 100%;
			text-align: center;
		}
		.doc {
			padding: 2rem 1.5rem;
		}
	}
</style>
